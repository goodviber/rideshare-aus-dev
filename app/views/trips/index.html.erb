<% content_for :header, javascript_include_tag("trips-search") %>

<div class="span-8">
  <fieldset>
    <legend><%= t "headings.search_filter" %></legend>

    <%= label(:trip, :from_location_id, t(:from), :class => 'search_loc_label') %>
    <input id="location_from" type="text" name="from_autocomplete" />
    <input id="trip_from_location_id" type="hidden" value ="" name="trip_from_location_id" />

    <%= label(:trip, :to_location_id, t(:to), :class => 'search_loc_label') %>
    <input id="location_to" type="text" name="to_autocomplete"/>
    <input id="trip_to_location_id" type="hidden" value ="" name="trip_to_location_id" />

    <div id="dateDiv"></div>

    <input id="trip_all_dates" type="checkbox" checked="checked" name="vehicle" value="Bike" /> <%= t :search_all_dates %><br />

    <div class="ui-style">
      <button id="filterButton"><%= t :search %></button>
    </div>
  </fieldset>

</div>

<div id="searchResultsContainer" class="prepend-1 span-13 last">

  <fieldset>
    <legend><%= t "headings.search_results" %></legend>
    <div id="loading"><%= image_tag("ajax-loader.gif", :alt => "Loading...") %> <%= t :loading %></div>
    <div id="searchResults">
    </div>
  </fieldset>
</div>

<div id="startupContainer" class="prepend-1 span-13 last">
  <br/>
  <br/>
  <h2>Sveiki atvykę į Pavešiu</h2>
  <p class="bodyFont">
    - Pavešiu, Važiuoju ir Tranzuok puslapiai vienoje vietoje<br/>
    - Kasdien pridedama 100+ naujų kelionių<br/>
    - <a href="<%= new_trip_url %>">Paskelbkite</a> savo kelionę ir ją pamatys visi<br/>
    - Paprasta ir lengvai suprantama kelionių paieška<br />
  </p>
  <p class="bodyFont">Paspauskite 'Ieškoti' mygtuką tam, kad pradėti!</p>
  <p class="bodyFont">Kaip galime pagerinti pavesiu.lt? Pateikite <a href="javascript:UserVoice.showPopupWidget();" title="Open feedback dialog">atsiliepimus čia</a></p>
</div>


<script>
  $(function() {
    function log( message ) {
      $( "<div/>" ).text( message ).prependTo( "#log" );
      $( "#log" ).scrollTop( 0 );
    }

    $( "#location_from" ).autocomplete({
      source: "<%= load_from_location_data_trips_path %>",
      minLength: 2,
      select: function( event, ui ) {
        console.log( ui.item ?
          "Selected: " + ui.item.value + " aka " + ui.item.id :
          "Nothing selected, input was " + this.value );
        $('#trip_from_location_id').val(ui.item.id);
      }
    });
  });
  
  $(function() {
    function log( message ) {
      $( "<div/>" ).text( message ).prependTo( "#log" );
      $( "#log" ).scrollTop( 0 );
    }

    $( "#location_to" ).autocomplete({
      source: "<%= load_to_location_data_trips_path %>",
      minLength: 2,
      select: function( event, ui ) {
        console.log( ui.item ?
          "Selected: " + ui.item.value + " aka " + ui.item.id :
          "Nothing selected, input was " + this.value );
        $('#trip_to_location_id').val(ui.item.id);
      }
    });
  });
</script>
